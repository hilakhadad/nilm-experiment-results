<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Threshold Report - House 5032</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: white;
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 10px;
        }

        header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        header .subtitle {
            opacity: 0.9;
        }

        .info-bar {
            display: flex;
            gap: 30px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .info-item {
            font-size: 0.9em;
            opacity: 0.85;
        }

        .info-item strong {
            opacity: 1;
        }

        section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        section h2 {
            color: #444;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }

        footer {
            text-align: center;
            padding: 20px;
            color: #888;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .container { padding: 10px; }
            header { padding: 20px; }
            section { padding: 15px; }
            .charts-grid { grid-template-columns: 1fr; }
            .info-bar { flex-direction: column; gap: 5px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Dynamic Threshold Analysis - House 5032</h1>
            <div class="subtitle">Generated: 2026-02-19 04:05</div>
            <div class="info-bar">
                <div class="info-item"><strong>Period:</strong> 2021-05-05 to 2026-01-05 (1706 days)</div>
                <div class="info-item"><strong>Thresholds:</strong> 2000W -> 1500W -> 1100W -> 800W</div>
                
            </div>
        </header>

        <div style="background:#e8daf0;border:1px solid #6f42c1;border-radius:6px;padding:8px 15px;margin-bottom:12px;font-size:0.82em;color:#4a0e6b;">NaN minutes (shown as "No Data"): w1: 39,222 min (2%), w2: 8,159 min (0%), w3: 184,616 min (8%)</div>

        <section>
            <h2>Power Decomposition Summary</h2>
            
    <p style="color: #555; margin-bottom: 15px; line-height: 1.5; font-size: 0.88em;">
        Total consumption (35819.57 kWh) = <strong>Explained</strong> (detected devices)
        + <strong>Background</strong> (always-on baseload)
        + <strong>Unmatched</strong> (above 800W, not matched)
        + <strong>Sub-threshold</strong> (below 800W, undetectable by design).
    </p>

    <div style="border: 2px solid #dee2e6; border-radius: 12px; padding: 18px; margin-bottom: 18px;">
        <div style="font-size: 0.82em; font-weight: 600; color: #555; margin-bottom: 12px;">
            Power Decomposition (= 100%)
        </div>
        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; margin-bottom: 12px;">
            <div style="background: #d4edda; border-left: 4px solid #28a745; border-radius: 8px; padding: 14px; text-align: center;">
                <div style="font-size: 1.8em; font-weight: bold; color: #28a745;">48.7%</div>
                <div style="font-size: 0.9em; color: #155724; font-weight: 600;">Explained</div>
                <div style="font-size: 0.8em; color: #666;">18017.44 kWh</div>
                <div style="font-size: 0.75em; color: #888; margin-top: 4px; line-height: 1.4;">
                    Matched ON&rarr;OFF events (boilers, ACs, high-power devices).<br>
                    <em>Per-minute difference: original &minus; remaining.</em>
                </div>
            </div>
            <div style="background: #e9ecef; border-left: 4px solid #6c757d; border-radius: 8px; padding: 14px; text-align: center;">
                <div style="font-size: 1.8em; font-weight: bold; color: #6c757d;">12.3%</div>
                <div style="font-size: 0.9em; color: #495057; font-weight: 600;">Background</div>
                <div style="font-size: 0.8em; color: #666;">4552.34 kWh</div>
                <div style="font-size: 0.75em; color: #888; margin-top: 4px; line-height: 1.4;">
                    Always-on baseload (~41W avg/phase).<br>
                    <em>P5 (5th percentile) &times; measured minutes.</em>
                </div>
            </div>
            <div style="background: #fff3cd; border-left: 4px solid #fd7e14; border-radius: 8px; padding: 14px; text-align: center;">
                <div style="font-size: 1.8em; font-weight: bold; color: #fd7e14;">13.6%</div>
                <div style="font-size: 0.9em; color: #856404; font-weight: 600;">Unmatched</div>
                <div style="font-size: 0.8em; color: #666;">5041.96 kWh</div>
                <div style="font-size: 0.75em; color: #888; margin-top: 4px; line-height: 1.4;">
                    Above 800W, not matched. Includes complex-pattern<br>
                    devices not targeted for detection.
                </div>
            </div>
            <div style="background: #fff8e1; border-left: 4px solid #ffc107; border-radius: 8px; padding: 14px; text-align: center;">
                <div style="font-size: 1.8em; font-weight: bold; color: #b8860b;">22.3%</div>
                <div style="font-size: 0.9em; color: #856404; font-weight: 600;">Sub-threshold</div>
                <div style="font-size: 0.8em; color: #666;">8249.4 kWh</div>
                <div style="font-size: 0.75em; color: #888; margin-top: 4px; line-height: 1.4;">
                    Between background and 800W.<br>
                    Below detection threshold &mdash; undetectable by design.
                </div>
            </div>
            <div style="background:#e8daf0; border-left: 4px solid #6f42c1; border-radius: 8px; padding: 14px; text-align: center;"><div style="font-size: 1.8em; font-weight: bold; color: #6f42c1;">3.2%</div><div style="font-size: 0.9em; color: #4a0e6b; font-weight: 600;">No Data</div><div style="font-size: 0.75em; color: #888; margin-top: 4px; line-height: 1.4;">Minutes with no power reading (NaN).<br><em>Not included in any calculation.</em></div></div>
        </div>
        <div style="background: #f8f9fa; border-radius: 6px; padding: 8px 15px; text-align: center; font-size: 0.82em; color: #555;">
            <span style="color:#28a745;">Explained (48.7%)</span> +
            <span style="color:#6c757d;">Background (12.3%)</span> +
            <span style="color:#fd7e14;">Unmatched (13.6%)</span> +
            <span style="color:#b8860b;">Sub-threshold (22.3%)</span>
             + <span style="color:#6f42c1;">No Data (3.2%)</span>
            = 100.1%
        </div>
    </div>

    <div style="background: #e8f5e9; border: 2px solid #28a745; border-radius: 12px; padding: 15px 20px; text-align: center; margin-bottom: 8px;">
        <div style="font-size: 2.8em; font-weight: bold; color: #28a745;">78.1%</div>
        <div style="font-size: 1em; font-weight: 700; color: #333;">Detection Efficiency</div>
        <div style="font-size: 0.82em; color: #555; margin-top: 4px; line-height: 1.5;">
            <strong>Efficiency</strong> = 18017.44 / (18017.44 + 5041.96) kWh
            = <strong style="color:#28a745;">78.1%</strong><br>
            <em>Scope: only above-threshold (&ge;800W) power. Background and sub-threshold excluded.</em>
        </div>
    </div>
    
        </section>

        <section>
            <h2>Power Breakdown by Phase</h2>
            <p style="color: #666; margin-bottom: 10px; font-size: 0.85em;">
                Per-phase (w1, w2, w3) decomposition into Explained, Background, Unmatched, and Sub-threshold.
            </p>
            
    <div id="power-breakdown-chart" style="width:100%;height:250px;"></div>
    <script>
        Plotly.newPlot('power-breakdown-chart', [{"y": ["w1", "w2", "w3"], "x": [65.8, 48.6, 31.4], "name": "Explained", "type": "bar", "orientation": "h", "marker": {"color": "#28a745"}, "text": ["65.8%", "48.6%", "31.4%"], "textposition": "inside", "hovertext": ["w1: 8998.64 kWh (65.8%)", "w2: 4658.62 kWh (48.6%)", "w3: 4360.18 kWh (31.4%)"], "hoverinfo": "text"}, {"y": ["w1", "w2", "w3"], "x": [0.0, 11.2, 25.1], "name": "Background", "type": "bar", "orientation": "h", "marker": {"color": "#6c757d"}, "text": ["0.0%", "11.2%", "25.1%"], "textposition": "inside", "hovertext": ["w1: 0.0 kWh (0.0%)", "w2: 1069.32 kWh (11.2%)", "w3: 3483.03 kWh (25.1%)"], "hoverinfo": "text"}, {"y": ["w1", "w2", "w3"], "x": [22.4, 15.5, 3.6], "name": "Unmatched", "type": "bar", "orientation": "h", "marker": {"color": "#fd7e14"}, "text": ["22.4%", "15.5%", "3.6%"], "textposition": "inside", "hovertext": ["w1: 3060.41 kWh (22.4%)", "w2: 1483.82 kWh (15.5%)", "w3: 497.73 kWh (3.6%)"], "hoverinfo": "text"}, {"y": ["w1", "w2", "w3"], "x": [10.2, 24.4, 32.5], "name": "Sub-threshold", "type": "bar", "orientation": "h", "marker": {"color": "#ffc107"}, "text": ["10.2%", "24.4%", "32.5%"], "textposition": "inside", "hovertext": ["w1: 1389.5 kWh (10.2%)", "w2: 2340.19 kWh (24.4%)", "w3: 4519.71 kWh (32.5%)"], "hoverinfo": "text"}, {"y": ["w1", "w2", "w3"], "x": [1.6, 0.3, 7.7], "name": "No Data", "type": "bar", "orientation": "h", "marker": {"color": "#6f42c1"}, "text": ["1.6%", "", "7.7%"], "textposition": "inside", "hovertext": ["w1: 39,222 NaN minutes (1.6%)", "w2: 8,159 NaN minutes (0.3%)", "w3: 184,616 NaN minutes (7.7%)"], "hoverinfo": "text"}], {"title": "Power Decomposition by Phase", "barmode": "stack", "xaxis": {"title": "% of Total Period", "range": [0, 105]}, "yaxis": {"title": ""}, "legend": {"orientation": "h", "y": -0.2}, "margin": {"l": 50, "r": 30, "t": 50, "b": 60}, "height": 250});
    </script>
    
            
    <table style="width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 0.9em;">
        <thead>
            <tr style="background: #f8f9fa;">
                <th style="padding: 10px 15px; text-align: left;">Phase</th>
                <th style="padding: 10px 15px; text-align: right;" title="Total original power consumption">Total</th>
                <th style="padding: 10px 15px; text-align: right; color: #28a745;" title="Power attributed to detected device activations">Explained</th>
                <th style="padding: 10px 15px; text-align: right; color: #6c757d;" title="Baseline power (5th percentile) - always-on devices">Background</th>
                <th style="padding: 10px 15px; text-align: right; color: #fd7e14;" title="Above minimum threshold, not matched to any device">Unmatched</th>
                <th style="padding: 10px 15px; text-align: right; color: #b8860b;" title="Between background and minimum threshold — undetectable by design">Sub-threshold</th>
                <th style="padding: 10px 15px; text-align: right; color: #6f42c1;" title="% of time with no power reading (NaN)">No Data</th>
                <th style="padding: 10px 15px; text-align: right;" title="Explained / (Explained + Unmatched) — only detectable power">Efficiency</th>
            </tr>
        </thead>
        <tbody>
            
        <tr>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; font-weight: 600;">w1</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right;">13448.55 kWh</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #28a745;">8998.64 kWh (65.8%)</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #6c757d;">0.0 kWh (0.0%)</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #fd7e14;">3060.41 kWh (22.4%)</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #b8860b;">1389.5 kWh (10.2%)</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #6f42c1;">1.6%</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right;">74.6%</td>
        </tr>
        
        <tr>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; font-weight: 600;">w2</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right;">9547.71 kWh</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #28a745;">4658.62 kWh (48.6%)</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #6c757d;">1069.32 kWh (11.2%)</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #fd7e14;">1483.82 kWh (15.5%)</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #b8860b;">2340.19 kWh (24.4%)</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #6f42c1;">0.3%</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right;">75.8%</td>
        </tr>
        
        <tr>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; font-weight: 600;">w3</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right;">12823.32 kWh</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #28a745;">4360.18 kWh (31.4%)</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #6c757d;">3483.03 kWh (25.1%)</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #fd7e14;">497.73 kWh (3.6%)</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #b8860b;">4519.71 kWh (32.5%)</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right; color: #6f42c1;">7.7%</td>
            <td style="padding: 10px 15px; border-bottom: 1px solid #eee; text-align: right;">89.8%</td>
        </tr>
        
        </tbody>
    </table>
    
        </section>

        <section>
            <h2>Detection Efficiency by Phase</h2>
            <p style="color: #666; margin-bottom: 10px; font-size: 0.85em;">
                Fraction of detectable power (Explained + Unmatched) matched to device events per phase.
            </p>
            <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
        <div style="text-align: center;">
            <div id="efficiency-gauge-chart-w1" style="width:200px;height:200px;display:inline-block;"></div>
            <div style="font-size: 0.85em; color: #666;">
                8998.64 / 13448.55 kWh
            </div>
            <script>
                Plotly.newPlot('efficiency-gauge-chart-w1', [{"values": [74.6, 25.400000000000006], "labels": ["Efficiency", ""], "type": "pie", "hole": 0.7, "marker": {"colors": ["#28a745", "#f0f0f0"]}, "textinfo": "none", "hoverinfo": "skip", "sort": false}], {"showlegend": false, "margin": {"l": 10, "r": 10, "t": 30, "b": 10}, "height": 200, "width": 200, "annotations": [{"text": "75%", "showarrow": false, "font": {"size": 24, "color": "#28a745", "family": "Arial Black"}, "x": 0.5, "y": 0.5}], "title": {"text": "w1", "font": {"size": 14}}},
                    {displayModeBar: false});
            </script>
        </div>
        
        <div style="text-align: center;">
            <div id="efficiency-gauge-chart-w2" style="width:200px;height:200px;display:inline-block;"></div>
            <div style="font-size: 0.85em; color: #666;">
                4658.62 / 8478.39 kWh
            </div>
            <script>
                Plotly.newPlot('efficiency-gauge-chart-w2', [{"values": [75.8, 24.200000000000003], "labels": ["Efficiency", ""], "type": "pie", "hole": 0.7, "marker": {"colors": ["#28a745", "#f0f0f0"]}, "textinfo": "none", "hoverinfo": "skip", "sort": false}], {"showlegend": false, "margin": {"l": 10, "r": 10, "t": 30, "b": 10}, "height": 200, "width": 200, "annotations": [{"text": "76%", "showarrow": false, "font": {"size": 24, "color": "#28a745", "family": "Arial Black"}, "x": 0.5, "y": 0.5}], "title": {"text": "w2", "font": {"size": 14}}},
                    {displayModeBar: false});
            </script>
        </div>
        
        <div style="text-align: center;">
            <div id="efficiency-gauge-chart-w3" style="width:200px;height:200px;display:inline-block;"></div>
            <div style="font-size: 0.85em; color: #666;">
                4360.18 / 9340.29 kWh
            </div>
            <script>
                Plotly.newPlot('efficiency-gauge-chart-w3', [{"values": [89.8, 10.200000000000003], "labels": ["Efficiency", ""], "type": "pie", "hole": 0.7, "marker": {"colors": ["#28a745", "#f0f0f0"]}, "textinfo": "none", "hoverinfo": "skip", "sort": false}], {"showlegend": false, "margin": {"l": 10, "r": 10, "t": 30, "b": 10}, "height": 200, "width": 200, "annotations": [{"text": "90%", "showarrow": false, "font": {"size": 24, "color": "#28a745", "family": "Arial Black"}, "x": 0.5, "y": 0.5}], "title": {"text": "w3", "font": {"size": 14}}},
                    {displayModeBar: false});
            </script>
        </div>
        </div>
        </section>

        <section>
            <h2>Threshold Contribution</h2>
            <p style="color: #666; margin-bottom: 10px; font-size: 0.85em;">
                Each iteration uses a lower threshold (2000W -> 1500W -> 1100W -> 800W) to detect progressively smaller devices.
            </p>
            
    <div id="threshold-waterfall-chart" style="width:100%;height:350px;"></div>
    <script>
        Plotly.newPlot('threshold-waterfall-chart', [{"type": "waterfall", "x": ["TH=2000W", "TH=1500W", "TH=1100W", "TH=800W", "Total"], "y": [11.7, 16.6, 18.3, 3.3, 49.9], "measure": ["relative", "relative", "relative", "relative", "total"], "text": ["+11.7%", "+16.6%", "+18.3%", "+3.3%", "49.9%"], "textposition": "outside", "connector": {"line": {"color": "#ccc"}}, "increasing": {"marker": {"color": "#28a745"}}, "totals": {"marker": {"color": "#667eea"}}}], {"title": "Contribution by Threshold Level", "yaxis": {"title": "% of Total Power Explained"}, "xaxis": {"title": ""}, "showlegend": false, "margin": {"t": 50, "b": 50}, "height": 350});
    </script>
    
        </section>

        <div class="charts-grid">
            <section>
                <h2>Remaining Power Analysis</h2>
                <p style="color: #666; margin-bottom: 8px; font-size: 0.82em;">
                    Unexplained power by magnitude: Noise (&lt;200W), Small Events (200-800W), Large Unmatched (&gt;800W).
                </p>
                
    <div id="remaining-analysis-chart" style="width:100%;height:400px;"></div>
    <script>
        Plotly.newPlot('remaining-analysis-chart', [{"values": [6100736, 647929, 172604], "labels": ["Noise / Baseload<br>(<200W above base)", "Small Events<br>(200-800W)", "Large Unmatched<br>(>800W)"], "type": "pie", "marker": {"colors": ["#6c757d", "#ffc107", "#fd7e14"]}, "textinfo": "percent+label", "hole": 0.4, "textposition": "outside"}], {"title": "Remaining Power Classification<br><sub>7,153,266 total minutes across all phases</sub>", "showlegend": false, "margin": {"t": 60, "b": 30, "l": 100, "r": 100}, "height": 400});
    </script>
    
            </section>

            <section>
                <h2>Device Summary</h2>
                <p style="color: #666; margin-bottom: 8px; font-size: 0.82em;">
                    Classified by power, duration, and phase patterns.
                </p>
                
    <table style="width: 100%; border-collapse: collapse; margin: 15px 0;">
        <thead>
            <tr style="background: #2d3748; color: white;">
                <th style="padding: 12px 15px; text-align: left;" title="Classified device type based on power, duration, and phase patterns">Device Type</th>
                <th style="padding: 12px 15px; text-align: center;" title="Number of matched ON/OFF activation pairs">Count</th>
                <th style="padding: 12px 15px; text-align: center;" title="Average ON magnitude across all activations of this type">Avg Power</th>
                <th style="padding: 12px 15px; text-align: center;" title="Average total duration from ON start to OFF end">Avg Duration</th>
                <th style="padding: 12px 15px; text-align: left;" title="This device type's energy share of all explained energy (magnitude x duration)">% of Explained Energy</th>
            </tr>
        </thead>
        <tbody>
            
        <tr>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; font-weight: 600;">Water Heater (Boiler)</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; text-align: center;">18739</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; text-align: center;">1,797W</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; text-align: center;">12 min</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee;">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <div style="background: #d4edda; border-radius: 4px; width: 100px; height: 18px; overflow: hidden;">
                        <div style="background: #28a745; height: 100%; width: 38.9%;"></div>
                    </div>
                    <span>38.9%</span>
                </div>
            </td>
        </tr>
        
        <tr>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; font-weight: 600;">Central AC (Multi-phase)</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; text-align: center;">88167</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; text-align: center;">1,314W</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; text-align: center;">5 min</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee;">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <div style="background: #d4edda; border-radius: 4px; width: 100px; height: 18px; overflow: hidden;">
                        <div style="background: #28a745; height: 100%; width: 48.1%;"></div>
                    </div>
                    <span>48.1%</span>
                </div>
            </td>
        </tr>
        
        <tr>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; font-weight: 600;">Regular AC (Single-phase)</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; text-align: center;">5249</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; text-align: center;">1,685W</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; text-align: center;">5 min</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee;">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <div style="background: #d4edda; border-radius: 4px; width: 100px; height: 18px; overflow: hidden;">
                        <div style="background: #28a745; height: 100%; width: 3.6%;"></div>
                    </div>
                    <span>3.6%</span>
                </div>
            </td>
        </tr>
        
        <tr>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; font-weight: 600;">Unclassified</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; text-align: center;">13996</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; text-align: center;">1,682W</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee; text-align: center;">5 min</td>
            <td style="padding: 12px 15px; border-bottom: 1px solid #eee;">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <div style="background: #d4edda; border-radius: 4px; width: 100px; height: 18px; overflow: hidden;">
                        <div style="background: #28a745; height: 100%; width: 9.4%;"></div>
                    </div>
                    <span>9.4%</span>
                </div>
            </td>
        </tr>
        
        </tbody>
    </table>
    <div style="font-size: 0.85em; color: #666; margin-top: 5px;">
        Total: 126151 matched activations, 48351 unmatched events
    </div>
    
            </section>
        </div>

        

        <footer>
            ElectricPatterns - Dynamic Threshold Experiment Report
        </footer>
    </div>

    <script>
    // Sort device activations tables by column
    var deviceSortState = {};
    function sortDeviceTable(tableId, colIdx, type) {
        var table = document.getElementById(tableId);
        if (!table) return;
        var tbody = table.querySelector('tbody');
        var rows = Array.from(tbody.querySelectorAll('tr'));
        var key = tableId + '-' + colIdx;
        var asc = deviceSortState[key] === undefined ? true : !deviceSortState[key];
        deviceSortState[key] = asc;

        rows.sort(function(a, b) {
            var cellA = a.cells[colIdx], cellB = b.cells[colIdx];
            var vA, vB;
            if (type === 'num') {
                vA = parseFloat(cellA.getAttribute('data-value') || cellA.textContent.replace(/[^0-9.-]/g, '')) || 0;
                vB = parseFloat(cellB.getAttribute('data-value') || cellB.textContent.replace(/[^0-9.-]/g, '')) || 0;
            } else {
                vA = (cellA.getAttribute('data-value') || cellA.textContent).trim();
                vB = (cellB.getAttribute('data-value') || cellB.textContent).trim();
                if (vA < vB) return asc ? -1 : 1;
                if (vA > vB) return asc ? 1 : -1;
                return 0;
            }
            return asc ? (vA - vB) : (vB - vA);
        });

        // Re-number rows
        rows.forEach(function(row, i) {
            row.cells[0].textContent = i + 1;
            tbody.appendChild(row);
        });
    }
    </script>
</body>
</html>